---
title: "Opensearch 은전한닢 설치 핸즈온"
description: "OpenSearch에서 은전한닢 플러그인을 설치하고 인덱스를 구성한 기록."
date: "2024-05-06"
published: true
tags: ["opensearch", "aws", "korean", "search"]
---

AWS 공식 문서에 은전한닢 설치/핸즈온이 있어서 따라해봤다.

- https://catalog.us-east-1.prod.workshops.aws/workshops/de4e38cb-a0d9-4ffe-a777-bf00d498fa49/ko-KR/indexing/blog-reindex#1-index

OpenSearch만 설치되어 있으면 된다.

## 은전한닢과 함께 인덱스 생성

```http
# create index with seunjeon
PUT korean-index
{
  "settings": {
    "analysis": {
      "tokenizer": {
        "seunjeon": {
          "type": "seunjeon_tokenizer"
        }
      },
      "analyzer": {
        "my_analyzer": {
          "type": "custom",
          "tokenizer": "seunjeon"
        }
      }
    }
  },
    "mappings": {
      "properties": {
        "title": {
          "type": "text"
        },
        "body": {
          "type": "text",
          "analyzer": "my_analyzer",
          "search_analyzer": "my_analyzer"
        }
      }
    }
  }
```

ES Dev Tools에서 플러그인을 확인할 수 있다.
`analysis-seunjeon`이 보인다.

![](/images/posts/4a7ba04a-5f33-4740-941c-4fcd4d2b7d62-image.png)

플러그인 버전별 호환성은 아래 문서를 참고하면 된다.

- https://docs.aws.amazon.com/opensearch-service/latest/developerguide/supported-plugins.html

## 색인 생성 및 쿼리

```http
# index document
PUT korean-index/_doc/1
{
  "title": "AWS Ground Station – 위성 데이터 수집 및 처리 서비스 정식 출시",
  "body": "지난 가을, AWS Ground Station에 대한 게시물에서 위성 데이터를 다운링크할 때 수행하는 단계를 미리 살펴봤습니다. 그동안 미리보기로 제공하던 AWS Ground Station을 정식 출시하고, 우선 미국 내 지상국 두 곳을 통해 바로 사용이 가능합니다. AWS Ground Station 사용하기 당시 설명한 것과 같이 첫 번째 단계는 위성의 NORAD ID 및 기타 정보를 AWS와 공유하여 AWS 계정에 위성을..."
}

# Query (출시, 출시하고 둘 다 쿼리가 되어야 한다)
GET korean-index/_search
{
  "query": {
    "match": {
      "body": {
        "query": "출시"
      }
    }
  }
}
```

기존 인덱스의 형태소 분석기를 교체하려면 새 인덱스를 구성해야 한다.
순서는 아래와 같다.

1. 새 인덱스 생성
2. 기존 데이터 이전
3. 인덱스 리네임
