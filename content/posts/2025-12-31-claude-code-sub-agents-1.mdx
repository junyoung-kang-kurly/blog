---
title: "Claude Code 서브에이전트 (1) - 기초"
description: "Claude Code에서 커스텀 서브에이전트를 만들고 실행하는 기본 방법."
date: "2025-12-31"
published: true
tags: ["claude-code", "sub-agent", "ai-agent"]
series: "claude-code-sub-agents"
seriesOrder: 1
---

## 들어가며

Anthropic의 [Building effective agents](https://www.anthropic.com/engineering/building-effective-agents) 문서를 보면 에이전트 워크플로우 패턴이 잘 정리되어 있다.
이론만 읽으면 감이 잘 안 오는데, Claude Code의 서브에이전트 기능으로 직접 실습해 보니 꽤 재미있었다.

이 시리즈에서는 서브에이전트를 활용한 다양한 워크플로우 패턴을 다룬다.
첫 번째 글에서는 서브에이전트의 기본 개념과 생성 방법을 정리한다.

## 서브에이전트란

Claude Code에서 서브에이전트는 특정 작업에 특화된 하위 에이전트다.
메인 에이전트가 Task tool로 서브에이전트를 호출하면, 서브에이전트는 자신의 도구와 시스템 프롬프트를 가지고 독립적으로 작업을 수행한다.

![](/images/posts/claude-code-sub-agents-1-basic-flow.svg)

장점:
- 역할 분리가 명확해진다
- 재사용이 가능하다
- 복잡한 작업을 분할 정복할 수 있다

## 서브에이전트 생성하기

Claude Code에서 `/agents` 명령어로 커스텀 서브에이전트를 만들 수 있다.

### 예시: 배송센터 이상치 탐지 에이전트

배송센터의 이상치를 탐지하는 에이전트를 만들어 봤다.

생성 프롬프트:

```
배송센터별로 이상치를 벗어났던 날짜들을 판별하세요. (IQR 기법을 이용하세요.)
```

### 도구 선택

에이전트에 쥐어줄 도구는 생성 시 직접 선택할 수 있다.
MCP 기반 도구들 중에서 필요한 것만 골라주면 된다.

이 경우 두 개를 선택했다:
- `get_delivery_init_data`: 배송 초기 데이터 조회
- `get_daily_delivery_metrics`: 일별 배송 메트릭 조회

### 생성된 에이전트 명세

```yaml
name: delivery-center-anomaly-detector
description: 배송센터 메트릭 분석 및 IQR 기법 이상치 탐지
tools: get_delivery_init_data, get_daily_delivery_metrics
model: sonnet
```

에이전트 명세에는 다음이 포함된다:
- **name**: 에이전트 식별자
- **description**: 언제 이 에이전트를 사용해야 하는지 설명
- **tools**: 사용 가능한 도구 목록
- **model**: 사용할 모델 (sonnet, haiku 등)
- **시스템 프롬프트**: 에이전트의 역할과 작업 방식 정의

## 에이전트 실행하기

만들어둔 에이전트는 메인 에이전트가 Task tool로 호출한다.

사용자 프롬프트 예시:

```
아래 5개의 배송센터의 메트릭을 확인하세요.
배송센터별로 이상치를 벗어났던 날짜들을 판별하세요. (IQR 기법을 이용하세요.)
delivery-center-anomaly-detector를 활용하세요.

## 탐색 범위
- 배송예정일: 2025-07-14 ~ 2025-08-14
- 배송센터: A, B, R, S, F
```

### 실행 흐름

1. 메인 에이전트가 사용자 프롬프트를 받는다
2. `delivery-center-anomaly-detector` 서브에이전트를 Task tool로 호출한다
3. 서브에이전트가 자신의 도구로 작업을 수행한다
4. 결과를 메인 에이전트에 반환한다
5. 메인 에이전트가 결과를 사용자에게 보여준다

### 서브에이전트에 전달되는 프롬프트

메인 에이전트는 서브에이전트를 호출할 때 상세한 요청사항을 전달한다:

```
다음 배송센터들의 메트릭을 확인하고 IQR 기법을 사용하여
이상치를 벗어난 날짜들을 판별하세요:

**탐색 범위:**
- 배송예정일: 2025-07-14 ~ 2025-08-14
- 배송센터: A, B, R, S, F

**수행할 작업:**
1. 각 배송센터의 메트릭 데이터 조회
2. IQR 기법으로 이상치 탐지
3. 이상치로 판별된 날짜들과 메트릭 값 식별

**반환해야 할 정보:**
- 각 배송센터별 분석 결과
- 이상치가 탐지된 날짜 목록
- IQR 계산 결과 (Q1, Q3, IQR, 경계값)
```

메인 에이전트가 사용자의 요청을 해석해서 서브에이전트에게 명확한 지시를 내린다.

## 에이전트 명세 작성 팁

### description이 중요하다

description은 메인 에이전트가 "이 서브에이전트를 언제 호출해야 하는지" 판단하는 기준이 된다.
구체적인 예시를 포함하면 호출 정확도가 올라간다.

```yaml
description: |
  Use this agent when you need to analyze delivery center metrics
  and identify anomalous dates using statistical methods.

  <example>
  user: "배송센터별로 이상치를 벗어났던 날짜들을 판별하세요."
  assistant: "delivery-center-anomaly-detector 에이전트를 사용하겠습니다."
  </example>
```

### 도구는 필요한 것만

도구를 너무 많이 주면 에이전트가 혼란스러워할 수 있다.
작업에 꼭 필요한 도구만 선택하는 게 좋다.

### 모델 선택

- **sonnet**: 복잡한 분석, 코드 작성이 필요한 경우
- **haiku**: 단순한 데이터 조회, 빠른 응답이 필요한 경우

비용과 성능의 트레이드오프를 고려해서 선택하면 된다.

## 정리

Claude Code의 `/agents` 명령어로 커스텀 서브에이전트를 만들 수 있다.
에이전트에 도구와 시스템 프롬프트를 지정하면, 메인 에이전트가 Task tool로 호출해서 사용한다.

다음 글에서는 서브에이전트를 병렬로 실행하고 결과를 취합하는 워크플로우를 다룬다.
